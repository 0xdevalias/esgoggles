<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <script src="jquery.js"></script>
    <script src="esprima.js"></script>
    <script src="estraverse.js"></script>
    <script src="almond.js"></script>
	<script>
	define('estraverse', estraverse);
	</script>
    <script src="escope.js"></script>
    <script src="Benchmark.js"></script>
    <script src="findVariables.js"></script>
    <script src="markFunctionCalls.js"></script>
    <script src="Ui_HighlightVariableReferences.js"></script>
    <script src="ast$.js"></script>
    <script src="raw_ast$.js"></script>
    <script src="raw_backbone.js"></script>
    <script src="raw_findVariables.js"></script>
    <script src="raw_openwebglobe.js"></script>
	<link rel='stylesheet' href='reset.css'/>
	<link rel='stylesheet' href='uml.css'/>
	<link rel='stylesheet' href='style2.css'/>
</head>
<body>
<script>



function style2(FILE) {
	var raw = window[FILE].toString().replace(new RegExp('^function '+FILE.replace('$','\\$')+'\\(\\)\\{|\\}$', 'g'),''),
		benchmark = new Benchmark(),
		ast,
		$ast

	benchmark
		.time('ast', function() {
			ast = esprima.parse(raw, {
				range: true,
				loc: false,
				comment: true,
				tolerant: false
			})
		})
		.time('ast$', function() {
			$ast = ast$(raw, ast)
		})

	setTimeout(function() {
		new Benchmark()
			.time('findVariables', function() {
				findVariables($ast)
			})
			.report()
	}, 0)

	benchmark.time('escope', function() {
			escope.analyze(ast)
		})
		.report()

	//markConsoleCallsForRemoval($ast)
	//markFunctionCalls($ast, 'highlighted', ['log'])

	initUi_HighlightVariableReferences($ast)

	$ast.appendTo('body')
}

$('body').on('click', 'es.FunctionExpression', function(event) {
	var $this = $(this)
	if ($this.is(event.target) || $this.is(event.target.parentNode))
		$(this).toggleClass('expanded')
})


//style2('raw_ast$')
//$('<hr/>').appendTo('body')
//style2('raw_findVariables')
//$('<hr/>').appendTo('body')
style2('raw_backbone')


</script>
</body>
</html>
